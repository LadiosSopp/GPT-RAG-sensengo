# GPT-RAG 2.0 Demo Outline

**日期**: 2026-01-13

---

## 一、RAG 系統演示

### 1.1 支援的文件類型展示

#### 📄 Word 文件 (.docx)
- 上傳 Word 文件至知識庫
- 展示文字內容擷取與索引
- 詢問文件中的特定資訊
- 驗證引用來源正確顯示

#### 📊 Excel 文件 (.xlsx)
- 上傳 Excel 試算表
- 展示表格資料的擷取能力
- 詢問數據相關問題
- 驗證數值與統計資訊正確性

#### 📑 PDF 文件 (.pdf)
- 上傳 PDF 文件（含文字與圖表）
- 展示 PDF 內容解析
- 跨頁內容搜尋與回答
- 驗證複雜排版的處理

#### 🖼️ 圖片 (.png, .jpg)
- 上傳包含文字的圖片
- 展示 OCR 文字辨識能力
- 圖片內容描述與問答
- 驗證圖片來源引用

### 1.2 RAG 功能亮點
- ✅ 即時時間統計顯示（各處理階段）
- ✅ Debug 面板（Timing & Prompting 詳情）
- ✅ 多模型切換支援
- ✅ Markdown 格式化回應
- ✅ 來源引用與連結

---

## 二、效能分析

### 2.1 目前瓶頸

| 階段 | 服務 | 平均耗時 | 說明 |
|------|------|----------|------|
| Thread 建立 | 🤖 AI Foundry | ~0.5秒 | API 初始化 |
| LLM 思考 #1 | 🤖 AI Foundry | ~3-5秒 | 決定是否呼叫工具 |
| 工具執行 | 🔎 AI Search | ~1-2秒 | Embeddings + 搜尋 |
| LLM 思考 #2 | 🤖 AI Foundry | **~8-15秒** ⚠️ | **主要瓶頸** |
| 回應生成 | 🤖 AI Foundry | ~2-5秒 | 串流輸出 |

**瓶頸原因**：
- AI Foundry Agent API 需處理大量搜尋結果
- 當前模型 (gpt-4.1) 處理速度較慢
- Search Result 預設返回 3 筆完整文件內容

### 2.2 目前配置
```
Model: gpt-4.1 (GlobalStandard SKU)
TPM: 40,000
SEARCH_RAGINDEX_TOP_K: 3
```

---

## 三、效能改善方案

### 3.1 減少搜尋結果數量

**方法**: 將 `SEARCH_RAGINDEX_TOP_K` 從 3 降為 2 或 1

```bash
# Container App 環境變數設定
SEARCH_RAGINDEX_TOP_K=2  # 或 1
```

**預期改善**:
- TOP_K=2: 減少 ~30% LLM 處理時間
- TOP_K=1: 減少 ~50% LLM 處理時間

**權衡**: 可能降低回答完整性

---

### 3.2 縮短搜尋結果長度

**方法**: 設定 `SEARCH_MAX_CONTENT_LENGTH` 限制每筆結果的字元數

```bash
SEARCH_MAX_CONTENT_LENGTH=2000  # 限制每筆結果最多 2000 字元
```

**預期改善**:
- 減少 Token 數量
- 加快 LLM 處理速度
- 降低 API 成本

---

### 3.3 切換至較快的 LLM 模型

**可用模型選項**:

| 模型 | 速度 | 品質 | 適用場景 |
|------|------|------|----------|
| gpt-4.1 | 慢 ⭐ | 高 ⭐⭐⭐ | 複雜推理、正式環境 |
| gpt-4o-mini | 快 ⭐⭐⭐ | 中 ⭐⭐ | 一般問答、快速回應 |
| gpt-5-mini | 最快 ⭐⭐⭐ | 中高 ⭐⭐ | 平衡速度與品質 |

**切換方式**:
1. 前端下拉選單即時切換
2. 或修改環境變數 `AZURE_OPENAI_CHATGPT_MODEL`

**預期改善**:
- 使用 gpt-4o-mini: 提升 60-70% 回應速度
- 使用 gpt-5-mini: 提升 50-60% 回應速度

---

## 四、Demo 流程建議

### Step 1: RAG 基本功能 (10 分鐘)
1. 開啟聊天介面
2. 詢問已索引的 Word/Excel/PDF 內容
3. 展示圖片 OCR 功能
4. 說明引用來源顯示

### Step 2: Debug 功能展示 (5 分鐘)
1. 展示即時計時器
2. 開啟 Debug 面板
3. 說明各階段時間分佈

### Step 3: 效能優化演示 (10 分鐘)
1. 展示目前回應時間（使用 gpt-4.1）
2. 切換至 gpt-5-mini 模型
3. 比較回應速度差異
4. 說明優化方案

---

## 五、Q&A 準備

### 常見問題
1. **Q: 為什麼不直接用 PTU?**
   - A: PTU 適合高流量場景，目前 POC 階段使用 PAYG 即可

2. **Q: 減少 TOP_K 會影響答案品質嗎?**
   - A: 會有些許影響，需根據實際使用場景權衡

3. **Q: 可以同時使用多個優化方案嗎?**
   - A: 可以，效果會疊加

---

## 六、環境資訊

| 項目 | 值 |
|------|-----|
| Frontend URL | `https://ca-d5teispadppru-frontend.calmcoast-6a1d388b.eastus2.azurecontainerapps.io` |
| Frontend Version | `live-timer-20260112` |
| Orchestrator Version | `newline-fix-20260112` |
| Azure OpenAI Account | `aif-d5teispadppru` |
| AI Search Service | (依實際環境) |

---

*最後更新: 2026-01-13*
