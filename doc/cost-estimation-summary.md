# GPT-RAG 解決方案 Azure 成本估算摘要

---

## ⚠️ 重要聲明

> **本文件僅供內部參考使用**
> 
> 1. 本估算為**單方面預估**，基於假設的使用情境計算
> 2. **實際費用將依客戶的真實使用情況而定**
> 3. 建議 Account 根據客戶的實際需求重新評估費用
> 4. Azure 價格可能隨時調整，請以 [Azure 官方定價](https://azure.microsoft.com/pricing/) 為準
> 5. 本估算不構成任何形式的報價或承諾

---

## 📊 成本估算結果摘要

### 假設條件

| 參數 | 大規模 | 中規模 | 小規模 |
|------|--------|--------|--------|
| 用戶數 | 1,000 人 | 100 人 | 10 人 |
| 文檔數量 | 1,000 份 | 100 份 | 10 份 |
| 每人每日查詢 | 20 次 | 15 次 | 10 次 |
| 每日新增文檔 | 20 份 | 5 份 | 1 份 |

---

### 每月成本估算 (USD)

#### 使用 GPT-4.1 模型

| 規模 | 每月費用 | 每年費用 |
|------|----------|----------|
| 🏢 **大規模** (1000人) | **$33,246** | **$398,952** |
| 🏠 **中規模** (100人) | **$2,807** | **$33,684** |
| 🏡 **小規模** (10人) | **$283** | **$3,390** |

#### 使用 GPT-5.2 模型

| 規模 | 每月費用 | 每年費用 |
|------|----------|----------|
| 🏢 **大規模** (1000人) | **$54,253** | **$651,036** |
| 🏠 **中規模** (100人) | **$4,383** | **$52,596** |
| 🏡 **小規模** (10人) | **$388** | **$4,650** |

---

### 成本結構概覽

| 服務類別 | 佔比 | 說明 |
|----------|------|------|
| **Azure OpenAI** | ~95% | 主要成本來源，按查詢量計費 |
| **Azure AI Search** | ~3% | 固定月費，依層級選擇 |
| **其他服務** | ~2% | Container Apps、Storage、監控等 |

---

### ⚠️ Document Intelligence 成本警告

> **實際案例**: 2026-01-20 發現 Document Intelligence 產生 **$2,000+ USD** 非預期費用

| 問題根因 | 說明 |
|---------|------|
| CRON 設定錯誤 | `*/5 * * * *` (每5分鐘) 導致每天執行 288 次 |
| Container OOM | 記憶體不足導致重啟循環 |
| 啟動時自動執行 | 每次重啟都觸發完整文件處理 |

**Document Intelligence 定價參考:**
| 模型 | 單價 |
|------|------|
| Layout (prebuilt-layout) | $10 / 1,000 頁 |
| Read | $1.50 / 1,000 頁 |

**建議設定:**
- CRON 排程: `0 */6 * * *` (每 6 小時) 或更低頻率
- Container 記憶體: 至少 2Gi (處理大型 PPTX)
- 設定 `RUN_JOBS_ON_STARTUP=false` 防止重啟時重複執行
- **務必設定 Azure 成本警報**

> 📄 詳細分析: [document-intelligence-cost-analysis.md](document-intelligence-cost-analysis.md)

---

### 費用調整因素

以下因素會顯著影響實際費用：

| 因素 | 影響 |
|------|------|
| **查詢頻率** | 查詢次數直接影響 OpenAI Token 消耗 |
| **文檔數量與大小** | 影響 Document Intelligence 和 Storage 費用 |
| **模型選擇** | GPT-5.2 比 GPT-4.1 貴約 67% |
| **回答長度** | Output Token 比 Input Token 貴 4 倍 |
| **部署區域** | 不同區域價格可能有 10-30% 差異 |

---

## 📋 費用估算模板

Account 可使用以下公式估算客戶費用：

```
月費估算 = (每日查詢數 × 30 × 每查詢成本) + 固定基礎設施費用

其中：
- 每查詢成本 (GPT-4.1) ≈ $0.05 USD
- 每查詢成本 (GPT-5.2) ≈ $0.09 USD
- 固定基礎設施費用 ≈ $280 ~ $1,000 USD/月 (依規模)
```

---

## 📚 參考資源

- [Azure 定價計算機](https://azure.microsoft.com/pricing/calculator/)
- [Azure OpenAI 定價](https://azure.microsoft.com/pricing/details/cognitive-services/openai-service/)
- [Azure AI Search 定價](https://azure.microsoft.com/pricing/details/search/)

---

> 📌 **致 Account**: 請根據客戶的實際使用情境（用戶數、查詢頻率、文檔量等）重新計算費用，本摘要僅提供參考基準。
